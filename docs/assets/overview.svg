<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="560" viewBox="0 0 1200 560">
  <defs>
    <style>
      .h1 { font: 800 26px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #0f172a; }
      .h2 { font: 700 16px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #0f172a; }
      .p  { font: 500 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #334155; }
      .k  { font: 700 12px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New"; fill: #0f172a; }
      .box { fill: #ffffff; stroke: #cbd5e1; stroke-width: 1.2; rx: 18; }
      .pill { fill: #f8fafc; stroke: #e2e8f0; stroke-width: 1.0; rx: 14; }
      .muted { fill: #475569; }
      .arrow { stroke: #64748b; stroke-width: 2; fill: none; marker-end: url(#m); }
      .num { font: 800 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #ffffff; }
      .bubble { fill: #0ea5e9; }
      .bubble2 { fill: #a855f7; }
    </style>
    <marker id="m" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L9,3 L0,6 Z" fill="#64748b"/>
    </marker>
  </defs>

  <rect x="0" y="0" width="1200" height="560" fill="#ffffff"/>

  <text x="48" y="66" class="h1">Predict the next pitch</text>
  <text x="48" y="94" class="p">Transformer policy model over within‑AB pitch history + game context (Statcast)</text>

  <!-- Step 1 -->
  <circle cx="66" cy="150" r="14" class="bubble"/>
  <text x="66" y="155" text-anchor="middle" class="num">1</text>
  <rect x="48" y="170" width="340" height="320" class="box"/>
  <text x="72" y="206" class="h2">Build the context</text>
  <text x="72" y="232" class="p">What the pitcher knows pre‑pitch.</text>

  <rect x="72" y="256" width="292" height="44" class="pill"/>
  <text x="88" y="283" class="p">Game state: balls/strikes, outs, inning</text>

  <rect x="72" y="312" width="292" height="44" class="pill"/>
  <text x="88" y="339" class="p">Runners + score differential</text>

  <rect x="72" y="368" width="292" height="44" class="pill"/>
  <text x="88" y="395" class="p">Who: pitcher/batter + handedness/stance</text>

  <rect x="72" y="424" width="292" height="52" class="pill"/>
  <text x="88" y="452" class="p">Within‑AB history (last L pitches)</text>
  <text x="88" y="472" class="k">hist_pitch_type_id_*  +  hist_plate_x/z_*</text>

  <!-- Step 2 -->
  <circle cx="458" cy="150" r="14" class="bubble2"/>
  <text x="458" y="155" text-anchor="middle" class="num">2</text>
  <rect x="440" y="170" width="360" height="320" class="box"/>
  <text x="464" y="206" class="h2">Transformer policy model</text>
  <text x="464" y="232" class="p">Encodes the pitch sequence + context.</text>

  <rect x="464" y="258" width="312" height="62" class="pill"/>
  <text x="480" y="286" class="p">Sequence encoder</text>
  <text x="480" y="308" class="p muted">learns within‑AB dynamics</text>

  <rect x="464" y="332" width="312" height="146" class="pill"/>
  <text x="480" y="360" class="p">Prediction heads</text>
  <text x="480" y="384" class="p">• pitch type distribution</text>
  <text x="480" y="408" class="p">• pitch location density (MDN)</text>
  <text x="480" y="432" class="p">• optional: outcome + next‑state</text>
  <text x="480" y="456" class="p muted">(enables open‑loop rollouts)</text>

  <!-- Step 3 -->
  <circle cx="870" cy="150" r="14" class="bubble"/>
  <text x="870" y="155" text-anchor="middle" class="num">3</text>
  <rect x="852" y="170" width="300" height="320" class="box"/>
  <text x="876" y="206" class="h2">Outputs you can inspect</text>
  <text x="876" y="232" class="p">Not just a single accuracy.</text>

  <rect x="876" y="256" width="252" height="56" class="pill"/>
  <text x="892" y="284" class="p">Pitch type</text>
  <text x="892" y="306" class="k">P(type | context, history)</text>

  <rect x="876" y="324" width="252" height="56" class="pill"/>
  <text x="892" y="352" class="p">Location</text>
  <text x="892" y="374" class="k">p(x,z | context, history)</text>

  <rect x="876" y="392" width="252" height="88" class="pill"/>
  <text x="892" y="420" class="p">Analysis products</text>
  <text x="892" y="444" class="p">• calibration + baselines</text>
  <text x="892" y="466" class="p">• pitcher policy profiles</text>

  <!-- Arrows -->
  <path d="M388 330 L440 330" class="arrow"/>
  <path d="M800 330 L852 330" class="arrow"/>

  <!-- Strike zone doodle -->
  <rect x="1042" y="272" width="86" height="86" fill="#ffffff" stroke="#94a3b8" stroke-width="1.2"/>
  <rect x="1061" y="292" width="48" height="46" fill="none" stroke="#0f172a" stroke-width="1.2"/>
  <ellipse cx="1076" cy="312" rx="12" ry="8" fill="#0ea5e9" fill-opacity="0.28" stroke="#0ea5e9" stroke-width="1.2"/>
  <ellipse cx="1090" cy="332" rx="10" ry="6" fill="#a855f7" fill-opacity="0.22" stroke="#a855f7" stroke-width="1.2"/>

</svg>
